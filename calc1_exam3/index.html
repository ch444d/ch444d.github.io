<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Calc 1 Practice – Section 5.3</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- MathJax configuration -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(', '\\)'], ['$', '$']]
      },
      startup: {
        typeset: false
      }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 1.5rem;
      background: #f4f4f5;
      color: #111827;
    }
    .app {
      max-width: 800px;
      margin: 0 auto;
      background: #ffffff;
      padding: 1.5rem;
      border-radius: 0.75rem;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.12);
    }
    h1 {
      margin-top: 0;
      font-size: 1.5rem;
    }
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1rem;
      align-items: center;
    }
    select, button {
      padding: 0.4rem 0.7rem;
      border-radius: 0.5rem;
      border: 1px solid #d4d4d8;
      background: #f9fafb;
      cursor: pointer;
      font-size: 0.9rem;
    }
    button.primary {
      background: #2563eb;
      color: white;
      border-color: #2563eb;
    }
    button.danger {
      background: #ef4444;
      color: white;
      border-color: #ef4444;
    }
    button.secondary {
      background: #e5e7eb;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .problem-card {
      border-radius: 0.75rem;
      padding: 1rem;
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      margin-bottom: 1rem;
    }
    .meta {
      font-size: 0.85rem;
      color: #6b7280;
      margin-bottom: 0.25rem;
    }
    .expression {
      font-size: 1.15rem;
      font-weight: 600;
      margin-bottom: 0.75rem;
      min-height: 1.5rem;
    }
    .answer {
      margin-top: 0.5rem;
      padding: 0.75rem;
      border-radius: 0.5rem;
      background: #ecfdf5;
      border: 1px solid #bbf7d0;
      font-size: 1rem;
    }
    .answer.hidden {
      display: none;
    }
    .stats {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      font-size: 0.9rem;
      margin-top: 0.5rem;
    }
    .stat-label {
      color: #6b7280;
      font-size: 0.8rem;
    }
    .stat-value {
      font-weight: 600;
    }
    .timer {
      font-size: 0.9rem;
      color: #4b5563;
    }
    @media (max-width: 600px) {
      body {
        padding: 0.75rem;
      }
      .app {
        padding: 1rem;
      }
      .controls {
        flex-direction: column;
        align-items: stretch;
      }
      select, button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <h1>Calc 1 Practice – Section 5.3 (Antiderivatives)</h1>
    <p style="font-size:0.9rem;color:#4b5563;margin-top:-0.5rem;">
      Choose a set, then click <strong>New Problem</strong>. Try it, reveal the answer, and mark yourself right or wrong.
    </p>

    <div class="controls">
      <label>
        Set:
        <select id="setSelect">
          <option value="all">All Sets</option>
          <option value="set1">Set 1 – General antiderivative</option>
          <option value="set2">Set 2 – Indefinite integrals</option>
        </select>
      </label>

      <button id="newBtn" class="primary">New Problem</button>
      <button id="showBtn" class="secondary" disabled>Show Answer</button>
      <button id="rightBtn" class="secondary" disabled>I got it right</button>
      <button id="wrongBtn" class="secondary" disabled>I got it wrong</button>
      <button id="resetBtn" class="danger" style="margin-left:auto;">Reset Stats</button>
    </div>

    <div class="problem-card">
      <div id="problemMeta" class="meta">No problem loaded yet.</div>
      <div id="problemExpression" class="expression"></div>
      <div id="answerBox" class="answer hidden">
        <strong>Answer:</strong>
        <div id="answerText"></div>
      </div>
    </div>

    <div class="stats">
      <div>
        <div class="stat-label">Attempted</div>
        <div id="statAttempted" class="stat-value">0</div>
      </div>
      <div>
        <div class="stat-label">Correct</div>
        <div id="statCorrect" class="stat-value">0</div>
      </div>
      <div>
        <div class="stat-label">Accuracy</div>
        <div id="statAccuracy" class="stat-value">0%</div>
      </div>
      <div>
        <div class="stat-label">Current problem time</div>
        <div id="timer" class="timer">0 s</div>
      </div>
    </div>
  </div>

  <script>
    // ---------- Problem data (inline, no external JSON) ----------
    const allProblems = [
      // Set 1
      { id: "S1-1", set: "set1", number: 1, section: "5.3",
        expression: "f(x) = 18x^{2}",
        answer: "F(x) = 6x^{3} + C" },
      { id: "S1-2", set: "set1", number: 2, section: "5.3",
        expression: "f(x) = x^{-3/5}",
        answer: "F(x) = \\frac{5}{2}x^{2/5} + C" },
      { id: "S1-3", set: "set1", number: 3, section: "5.3",
        expression: "f(x) = 2x^{4} - 24x^{2}",
        answer: "F(x) = \\frac{2}{5}x^{5} - 8x^{3} + C" },
      { id: "S1-4", set: "set1", number: 4, section: "5.3",
        expression: "f(x) = 9x + 15x^{-2}",
        answer: "F(x) = \\frac{9}{2}x^{2} - \\frac{15}{x} + C" },
      { id: "S1-5", set: "set1", number: 5, section: "5.3",
        expression: "f(x) = 2\\cos(x) - 9\\sin(x)",
        answer: "F(x) = 2\\sin(x) + 9\\cos(x) + C" },
      { id: "S1-6", set: "set1", number: 6, section: "5.3",
        expression: "f(x) = 4x^{7} - 3\\cos(x)",
        answer: "F(x) = \\frac{1}{2}x^{8} - 3\\sin(x) + C" },
      { id: "S1-7", set: "set1", number: 7, section: "5.3",
        expression: "f(x) = \\sin(2x) + 12\\cos(3x)",
        answer: "F(x) = -\\frac{1}{2}\\cos(2x) + 4\\sin(3x) + C" },
      { id: "S1-8", set: "set1", number: 8, section: "5.3",
        expression: "f(x) = \\sin(4 - 9x)",
        answer: "F(x) = -\\frac{1}{9}\\cos(4 - 9x) + C" },

      // Set 2
      { id: "S2-10", set: "set2", number: 10, section: "5.3",
        expression: "\\int (9x+2)\\,dx",
        answer: "\\frac{9}{2}x^{2} + 2x + C" },
      { id: "S2-11", set: "set2", number: 11, section: "5.3",
        expression: "\\int (4-18x)\\,dx",
        answer: "4x - 9x^{2} + C" },
      { id: "S2-12", set: "set2", number: 12, section: "5.3",
        expression: "\\int x^{-3}\\,dx",
        answer: "-\\frac{1}{2x^{2}} + C" },
      { id: "S2-13", set: "set2", number: 13, section: "5.3",
        expression: "\\int t^{-6/11}\\,dt",
        answer: "\\frac{11}{5}t^{5/11} + C" },
      { id: "S2-14", set: "set2", number: 14, section: "5.3",
        expression: "\\int \\bigl(5t^{3} - t^{-3}\\bigr)\\,dt",
        answer: "\\frac{5}{4}t^{4} + \\frac{1}{2}t^{-2} + C" },
      { id: "S2-15", set: "set2", number: 15, section: "5.3",
        expression: "\\int \\bigl(18t^{5} - 10t^{4} - 28t\\bigr)\\,dt",
        answer: "3t^{6} - 2t^{5} - 14t^{2} + C" },
      { id: "S2-16", set: "set2", number: 16, section: "5.3",
        expression: "\\int 14s^{9/5}\\,ds",
        answer: "5s^{14/5} + C" },
      { id: "S2-17", set: "set2", number: 17, section: "5.3",
        expression: "\\int \\bigl(z^{-4/5} - z^{2/3} + z^{5/4}\\bigr)\\,dz",
        answer: "5z^{1/5} - \\frac{3}{5}z^{5/3} + \\frac{4}{9}z^{9/4} + C" },
      { id: "S2-18", set: "set2", number: 18, section: "5.3",
        expression: "\\int \\frac{3}{2}\\,dx",
        answer: "\\frac{3}{2}x + C" },
      { id: "S2-19", set: "set2", number: 19, section: "5.3",
        expression: "\\int x^{-1/3}\\,dx",
        answer: "\\frac{3}{2}x^{2/3} + C" },
      { id: "S2-20", set: "set2", number: 20, section: "5.3",
        expression: "\\int x^{-4/3}\\,dx",
        answer: "-3x^{-1/3} + C" },
      { id: "S2-21", set: "set2", number: 21, section: "5.3",
        expression: "\\int 36t^{-3}\\,dt",
        answer: "-18t^{-2} + C" },
      { id: "S2-22", set: "set2", number: 22, section: "5.3",
        expression: "\\int x(x^{2} - 4)\\,dx",
        answer: "\\frac{1}{4}x^{4} - 2x^{2} + C" },
      { id: "S2-23", set: "set2", number: 23, section: "5.3",
        expression: "\\int (t^{1/2} + 1)(t+1)\\,dt",
        answer: "\\frac{2}{5}t^{5/2} + \\frac{2}{3}t^{3/2} + \\frac{1}{2}t^{2} + t + C" },
      { id: "S2-24", set: "set2", number: 24, section: "5.3",
        expression: "\\int \\frac{12 - z}{\\sqrt{z}}\\,dz",
        answer: "24\\sqrt{z} - \\frac{2}{3}z^{3/2} + C" },
      { id: "S2-25", set: "set2", number: 25, section: "5.3",
        expression: "\\int \\frac{x^{3} - 4}{x^{2}}\\,dx",
        answer: "\\frac{1}{2}x^{2} + \\frac{4}{x} + C" }
    ];

    let filteredProblems = [];
    let currentProblem = null;

    let attempted = 0;
    let correct = 0;

    let timerInterval = null;
    let currentSeconds = 0;

    const setSelect   = document.getElementById("setSelect");
    const newBtn      = document.getElementById("newBtn");
    const showBtn     = document.getElementById("showBtn");
    const rightBtn    = document.getElementById("rightBtn");
    const wrongBtn    = document.getElementById("wrongBtn");
    const resetBtn    = document.getElementById("resetBtn");

    const problemMeta       = document.getElementById("problemMeta");
    const problemExpression = document.getElementById("problemExpression");
    const answerBox         = document.getElementById("answerBox");
    const answerText        = document.getElementById("answerText");

    const statAttempted = document.getElementById("statAttempted");
    const statCorrect   = document.getElementById("statCorrect");
    const statAccuracy  = document.getElementById("statAccuracy");
    const timerDisplay  = document.getElementById("timer");

    function renderMath() {
      if (window.MathJax && MathJax.typesetPromise) {
        MathJax.typesetPromise();
      }
    }

    function applyFilter() {
      const setValue = setSelect.value;
      if (setValue === "all") {
        filteredProblems = allProblems.slice();
      } else {
        filteredProblems = allProblems.filter(p => p.set === setValue);
      }
      currentProblem = null;
      problemMeta.textContent = "Filter applied. Click \"New Problem\" to begin.";
      problemExpression.innerHTML = "";
      hideAnswer();
      stopTimer();
      currentSeconds = 0;
      updateTimerDisplay();
      renderMath();
    }

    function startTimer() {
      stopTimer();
      currentSeconds = 0;
      updateTimerDisplay();
      timerInterval = setInterval(() => {
        currentSeconds += 1;
        updateTimerDisplay();
      }, 1000);
    }

    function stopTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
    }

    function updateTimerDisplay() {
      timerDisplay.textContent = currentSeconds + " s";
    }

    function pickRandomProblem() {
      if (!filteredProblems.length) {
        problemMeta.textContent = "No problems available for this filter.";
        problemExpression.innerHTML = "";
        hideAnswer();
        disableAnswerButtons();
        renderMath();
        return;
      }

      const idx = Math.floor(Math.random() * filteredProblems.length);
      currentProblem = filteredProblems[idx];

      const setLabel = currentProblem.set === "set1"
        ? "Set 1 – General antiderivative"
        : currentProblem.set === "set2"
          ? "Set 2 – Indefinite integrals"
          : currentProblem.set;

      problemMeta.textContent =
        `${setLabel}, Problem ${currentProblem.number} (Book Sec. ${currentProblem.section})`;

      problemExpression.innerHTML = `\$begin:math:text$\$\{currentProblem\.expression\}\\$end:math:text$`;
      renderMath();

      hideAnswer();
      enableAnswerButtons();
      startTimer();
    }

    function showAnswer() {
      if (!currentProblem) return;
      answerText.innerHTML = `\$begin:math:text$\$\{currentProblem\.answer\}\\$end:math:text$`;
      answerBox.classList.remove("hidden");
      renderMath();
    }

    function hideAnswer() {
      answerBox.classList.add("hidden");
    }

    function updateStats() {
      statAttempted.textContent = attempted;
      statCorrect.textContent = correct;
      const accuracy = attempted === 0 ? 0 : Math.round((correct / attempted) * 100);
      statAccuracy.textContent = accuracy + "%";
    }

    function markRight() {
      if (!currentProblem) return;
      attempted += 1;
      correct += 1;
      updateStats();
      stopTimer();
      disableAnswerButtons();
    }

    function markWrong() {
      if (!currentProblem) return;
      attempted += 1;
      updateStats();
      stopTimer();
      disableAnswerButtons();
    }

    function resetStats() {
      attempted = 0;
      correct = 0;
      updateStats();
    }

    function enableAnswerButtons() {
      showBtn.disabled = false;
      rightBtn.disabled = false;
      wrongBtn.disabled = false;
    }

    function disableAnswerButtons() {
      showBtn.disabled = true;
      rightBtn.disabled = true;
      wrongBtn.disabled = true;
    }

    setSelect.addEventListener("change", applyFilter);
    newBtn.addEventListener("click", pickRandomProblem);
    showBtn.addEventListener("click", showAnswer);
    rightBtn.addEventListener("click", markRight);
    wrongBtn.addEventListener("click", markWrong);
    resetBtn.addEventListener("click", () => {
      resetStats();
      stopTimer();
      currentSeconds = 0;
      updateTimerDisplay();
    });

    updateStats();
    updateTimerDisplay();
    applyFilter();
  </script>
</body>
</html>